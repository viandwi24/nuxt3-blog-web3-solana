import{_ as K}from"./Card.9b75e3a1.js";import{r as p,a as A,w as B,b as D,e as E,o as a,f as r,h as b,i as m,u as o,F as w,j as k,k as S,l as s,c as N,t as g,m as P}from"./entry.6f81f143.js";import{u as L,g as U,a as R}from"./use-auth.433303ab.js";const V=()=>{const{program:l,BLOG_ADDRESS:_}=L(),c=p(!1),u=p([]),n=async()=>{c.value=!0;const d=(await l.value.account.userAccount.all(_.toBuffer())).filter(t=>U(t.account.authority.toBuffer()).toString()===t.publicKey.toString());u.value=d.map(t=>({address:t.publicKey.toString(),name:t.account.name,avatar:t.account.image,authority:t.account.authority.toString()})),c.value=!1};return A(()=>{n()}),B(()=>n()),{loading:c,users:u}},$=()=>{const{program:l,BLOG_ADDRESS:_}=L(),c=p(!1),u=p([]),n=async()=>{c.value=!0;const d=await l.value.account.postAccount.all(_.toBuffer());u.value=d.map(t=>({address:t.publicKey.toString(),title:t.account.title,content:t.account.content,user:t.account.user.toString()})),c.value=!1};return A(()=>{n()}),B(()=>n()),{loading:c,posts:u}},F=l=>l.slice(0,6)+"..."+l.slice(-4),G=s("div",{class:"font-bold text-xl"},"Users",-1),O={key:0,class:"flex space-x-2"},j=["href"],z=["src","alt"],I={key:1,class:"w-full text-center"},M={key:2,class:"w-full text-center"},q={class:"flex space-x-2 items-center mb-4"},H={class:"w-4 h-4 rounded-full bg-slate-600 overflow-hidden"},J=["src"],Q=s("div",{class:"w-1 h-1 bg-gray-500"},null,-1),T={class:"text-xs font-thin"},W=s("div",{class:"w-1 h-1 bg-gray-500"},null,-1),X=["href"],Y={class:"text-lg font-semibold capitalize"},Z=["href"],tt={key:1},st=s("div",{class:"w-full text-center"},"No posts found",-1),et=[st],ot={key:2,class:"w-full text-center"},rt=D({__name:"index",setup(l){const _=E(),{isLogged:c,isConnected:u}=R(),{users:n,loading:d}=V(),{posts:t,loading:h}=$();u.value&&!c.value&&_.push("/profile");const f=i=>(console.log(),n.value.find(y=>y.address===i)),v=i=>`https://solaneyes.com/address/${i}?cluster=devnet`;return(i,y)=>{const x=K,C=P;return a(),r("div",null,[b(x,{class:"mb-6"},{header:m(()=>[G]),default:m(()=>[!o(d)&&o(n).length>0?(a(),r("div",O,[(a(!0),r(w,null,k(o(n),e=>(a(),r("a",{key:e.address,class:"w-12 h-12 bg-slate-500 rounded-full",href:v(e.address),target:"_blank"},[s("img",{src:e.avatar,class:"w-12 h-12 rounded-full",alt:`Avatar of ${e.name}`},null,8,z)],8,j))),128))])):!o(d)&&o(n).length===0?(a(),r("div",I,"No users found")):o(d)?(a(),r("div",M,"Loading...")):S("",!0)]),_:1}),!o(h)&&o(t).length>0?(a(!0),r(w,{key:0},k(o(t),e=>(a(),N(x,{key:e.address,class:"mb-6"},{default:m(()=>[s("div",q,[s("div",H,[s("img",{src:f(e.user)?.avatar,class:"w-full h-full",alt:"Avatar"},null,8,J)]),Q,s("div",T,g(f(e.user)?.name),1),W,s("a",{href:v(f(e.user)?.authority||""),target:"_blank",class:"text-xs font-thin underline hover:text-primary-500"},g(("shortPubKey"in i?i.shortPubKey:o(F))(f(e.user)?.authority||"")),9,X)]),s("div",Y,[s("span",null,g(e.title),1),s("a",{href:v(e.address),target:"_blank"},[b(C,{name:"ic:round-open-in-new",class:"inline-block text-xs ml-1"})],8,Z)]),s("div",null,g(e.content),1)]),_:2},1024))),128)):!o(h)&&o(t).length===0?(a(),r("div",tt,et)):o(h)?(a(),r("div",ot,"Loading posts...")):S("",!0)])}}});export{rt as default};
