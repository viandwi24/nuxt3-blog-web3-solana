import{_ as w}from"./Card.9b75e3a1.js";import{b,e as y,R as P,U as C,o as f,c as A,i as _,l as t,V as h,W as x,u as a,t as k,f as B,k as S,P as T}from"./entry.6f81f143.js";import{a as m,u as V,b as D,c as L}from"./use-auth.433303ab.js";const I=t("div",{class:"font-bold text-xl"},"Create New Post",-1),N={class:"flex flex-col space-y-4"},R={class:"flex space-x-2"},U={class:"flex w-full"},$=t("div",{class:"w-1/5 mt-2"},"Post Title",-1),E={class:"flex-1"},M={class:"flex space-x-2"},j={class:"flex w-full"},G=t("div",{class:"w-1/5 mt-2"},"Post Content",-1),K={class:"flex-1 flex flex-col space-y-2"},O={class:"font-thin text-sm"},W={class:"flex items-center justify-end"},J=b({__name:"post",setup(q){const l=y(),e=m(),{program:r,BLOG_ADDRESS:d}=V();m();const i=D(),u=()=>{(!e.isConnected.value||!e.check())&&l.push("/")};u(),P(e.isConnected,p=>{u()});const s=C({title:"",content:""}),v=async()=>{i.show(),e.wallet.value?(e?.wallet?.value).toBuffer():Buffer.from("");const o=(await r.value.account.blogAccount.fetch(d)).lastPostId,c=L(new T(e.user.value?.address||"").toBuffer(),o.toString());try{const n=await r.value.methods.createPost(s.title,s.content,o.toString()).accounts({postAccount:c,blogAccount:d,userAccount:e.user.value?.address}).rpc();await new Promise(g=>setTimeout(g,5e3)),await l.push("/")}catch(n){console.log(n)}i.hide()};return(p,o)=>{const c=w;return f(),A(c,null,{header:_(()=>[I]),default:_(()=>[t("div",N,[t("div",R,[t("div",U,[$,t("div",E,[h(t("input",{type:"text",class:"w-full border-2 border-white/10 rounded-lg px-4 py-2 bg-transparent text-white read-only:bg-slate-800",placeholder:"Post Title","onUpdate:modelValue":o[0]||(o[0]=n=>a(s).title=n)},null,512),[[x,a(s).title]])])])]),t("div",M,[t("div",j,[G,t("div",K,[h(t("textarea",{class:"w-full border-2 border-white/10 rounded-lg px-4 py-2 bg-transparent text-white read-only:bg-slate-800",placeholder:"Post Title","onUpdate:modelValue":o[1]||(o[1]=n=>a(s).content=n),maxlength:2048},null,512),[[x,a(s).content]]),t("div",O,"* "+k(a(s).content.length)+" / 2048 characters",1)])])]),t("div",W,[a(e).isConnected.value&&a(e).isLogged.value?(f(),B("button",{key:0,class:"bg-primary-500 rounded-lg px-4 py-2 text-white font-bold",onClick:v}," Create Post ")):S("",!0)])])]),_:1})}}});export{J as default};
